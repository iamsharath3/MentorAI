<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MentorAI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-3xl bg-white rounded-xl shadow-2xl p-8 space-y-8">
        <header class="text-center">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-800">Your AI Career Guide</h1>
            <p class="mt-2 text-gray-600">Enter your details to discover personalized career opportunities powered by Generative AI.</p>
        </header>

        <form id="careerForm" class="space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="education" class="block text-sm font-medium text-gray-700">Highest Education</label>
                    <select id="education" name="education" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                        <option value="">Select your education level</option>
                        <option value="High School">High School</option>
                        <option value="Associate's Degree">Associate's Degree</option>
                        <option value="Bachelor's Degree">Bachelor's Degree</option>
                        <option value="Master's Degree">Master's Degree</option>
                        <option value="Doctorate (Ph.D.)">Doctorate (Ph.D.)</option>
                    </select>
                </div>

                <div>
                    <label for="major" class="block text-sm font-medium text-gray-700">Major / Field of Study</label>
                    <input type="text" id="major" name="major" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2" placeholder="e.g., Computer Science, Biology, Marketing">
                </div>
            </div>

            <div>
                <label for="skills" class="block text-sm font-medium text-gray-700">Key Skills</label>
                <textarea id="skills" name="skills" rows="3" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2" placeholder="List your technical and soft skills, separated by commas (e.g., Python, teamwork, data analysis)"></textarea>
            </div>

            <div>
                <label for="interests" class="block text-sm font-medium text-gray-700">Interests & Hobbies</label>
                <textarea id="interests" name="interests" rows="3" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2" placeholder="What are you passionate about? (e.g., video games, reading, volunteering)"></textarea>
            </div>

            <div>
                <label for="goals" class="block text-sm font-medium text-gray-700">Career Goals</label>
                <textarea id="goals" name="goals" rows="3" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2" placeholder="Describe what you want to achieve in your career"></textarea>
            </div>

            <button type="submit" id="submitBtn" class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all">
                Find My Opportunities
            </button>
        </form>

        <div id="loading" class="hidden flex items-center justify-center space-x-2">
            <div class="w-4 h-4 rounded-full animate-pulse bg-indigo-500"></div>
            <div class="w-4 h-4 rounded-full animate-pulse bg-indigo-500 delay-150"></div>
            <div class="w-4 h-4 rounded-full animate-pulse bg-indigo-500 delay-300"></div>
            <span class="text-gray-500 font-medium">Thinking like a pro...</span>
        </div>
        
        <div id="output" class="hidden">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4">Possible Career Opportunities</h2>
            <div id="resultsContent" class="prose max-w-none text-gray-700"></div>
        </div>
        
        <div id="additionalFeatures" class="hidden space-y-6">
            <div id="featureButtons" class="flex flex-col sm:flex-row gap-4 justify-center">
                <button id="coverLetterBtn" class="flex-1 py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-all">
                    ✨ Generate Cover Letter
                </button>
                <button id="interviewPrepBtn" class="flex-1 py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition-all">
                    ✨ Generate Interview Prep
                </button>
                <button id="generateRoadmapBtn" class="flex-1 py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-sky-600 hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-500 transition-all">
                    ✨ Generate Career Roadmap
                </button>
            </div>

            <div id="coverLetterOutput" class="hidden mt-6">
                <h3 class="text-xl font-semibold text-gray-800 mb-2">Generated Cover Letter</h3>
                <div id="coverLetterContent" class="bg-gray-50 p-6 rounded-lg shadow-inner prose max-w-none text-gray-700"></div>
                <button id="copyCoverLetterBtn" class="mt-4 w-full py-2 px-4 rounded-lg text-sm font-medium text-indigo-600 border border-indigo-600 hover:bg-indigo-50 transition-colors">
                    Copy to Clipboard
                </button>
            </div>

            <div id="interviewPrepOutput" class="hidden mt-6">
                <h3 class="text-xl font-semibold text-gray-800 mb-2">Interview Preparation Guide</h3>
                <div id="interviewPrepContent" class="bg-gray-50 p-6 rounded-lg shadow-inner prose max-w-none text-gray-700"></div>
                <button id="copyInterviewPrepBtn" class="mt-4 w-full py-2 px-4 rounded-lg text-sm font-medium text-indigo-600 border border-indigo-600 hover:bg-indigo-50 transition-colors">
                    Copy to Clipboard
                </button>
            </div>

            <div id="roadmapOutput" class="hidden mt-6">
                <h3 class="text-xl font-semibold text-gray-800 mb-2">Career Roadmap</h3>
                <div id="roadmapContent" class="bg-gray-50 p-6 rounded-lg shadow-inner prose max-w-none text-gray-700"></div>
                <button id="copyRoadmapBtn" class="mt-4 w-full py-2 px-4 rounded-lg text-sm font-medium text-indigo-600 border border-indigo-600 hover:bg-indigo-50 transition-colors">
                    Copy to Clipboard
                </button>
            </div>
        </div>

        <div id="error-message" class="hidden bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative" role="alert">
            <strong class="font-bold">Error!</strong>
            <span class="block sm:inline" id="error-text"></span>
        </div>
    </div>

    <script type="module">
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('careerForm');
            const outputDiv = document.getElementById('output');
            const resultsDiv = document.getElementById('resultsContent');
            const loadingDiv = document.getElementById('loading');
            const errorDiv = document.getElementById('error-message');
            const errorText = document.getElementById('error-text');
            const additionalFeaturesDiv = document.getElementById('additionalFeatures');
            const coverLetterBtn = document.getElementById('coverLetterBtn');
            const interviewPrepBtn = document.getElementById('interviewPrepBtn');
            const generateRoadmapBtn = document.getElementById('generateRoadmapBtn');
            
            const coverLetterOutput = document.getElementById('coverLetterOutput');
            const coverLetterContent = document.getElementById('coverLetterContent');
            const interviewPrepOutput = document.getElementById('interviewPrepOutput');
            const interviewPrepContent = document.getElementById('interviewPrepContent');
            const roadmapOutput = document.getElementById('roadmapOutput');
            const roadmapContent = document.getElementById('roadmapContent');
            
            const copyCoverLetterBtn = document.getElementById('copyCoverLetterBtn');
            const copyInterviewPrepBtn = document.getElementById('copyInterviewPrepBtn');
            const copyRoadmapBtn = document.getElementById('copyRoadmapBtn');

            let studentProfile = {};
            let selectedCareer = '';

            const handleAPIRequest = async (prompt, targetDiv, resetOtherOutputs = true) => {
                loadingDiv.classList.remove('hidden');
                errorDiv.classList.add('hidden');
                
                if (resetOtherOutputs) {
                    coverLetterOutput.classList.add('hidden');
                    interviewPrepOutput.classList.add('hidden');
                    roadmapOutput.classList.add('hidden');
                }
                
                const payload = {
                    contents: [{ parts: [{ text: prompt }] }],
                    tools: [{ "google_search": {} }],
                    systemInstruction: {
                        parts: [{ text: "You are a helpful and knowledgeable career counselor." }]
                    },
                };
                
                // Add your Gemini API Key here
                const apiKey = "AIzaSyA2OvcgpxDDwU9PdecmE5P4lIDrWZ5b8yc"; 
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error?.message || `API error: ${response.status}`);
                    }

                    const result = await response.json();
                    const text = result?.candidates?.[0]?.content?.parts?.[0]?.text || "No content found. Please try again.";
                    
                    targetDiv.innerHTML = formatResponse(text);
                    targetDiv.parentElement.classList.remove('hidden');

                } catch (error) {
                    console.error('An error occurred:', error);
                    errorText.textContent = `Failed to generate content: ${error.message}`;
                    errorDiv.classList.remove('hidden');
                } finally {
                    loadingDiv.classList.add('hidden');
                }
            };
            
            form.addEventListener('submit', async (e) => {
                e.preventDefault();

                // Hide previous results and errors, show loading spinner
                outputDiv.classList.add('hidden');
                additionalFeaturesDiv.classList.add('hidden');
                coverLetterOutput.classList.add('hidden');
                interviewPrepOutput.classList.add('hidden');
                roadmapOutput.classList.add('hidden');
                errorDiv.classList.add('hidden');
                loadingDiv.classList.remove('hidden');
                
                studentProfile = {
                    education: document.getElementById('education').value,
                    major: document.getElementById('major').value,
                    skills: document.getElementById('skills').value,
                    interests: document.getElementById('interests').value,
                    goals: document.getElementById('goals').value,
                };

                // Construct the prompt for the initial career opportunities
                const prompt = `Act as an expert career counselor. Based on the following student details, suggest a list of 3-5 possible career opportunities and a brief explanation for why each is a good fit. Please be concise and professional.
                
                Student Profile:
                - Highest Education: ${studentProfile.education}
                - Major/Field of Study: ${studentProfile.major}
                - Key Skills: ${studentProfile.skills}
                - Interests & Hobbies: ${studentProfile.interests}
                - Career Goals: ${studentProfile.goals}`;

                const payload = {
                    contents: [{ parts: [{ text: prompt }] }],
                    tools: [{ "google_search": {} }],
                    systemInstruction: {
                        parts: [{ text: "You are a helpful and knowledgeable career counselor." }]
                    },
                };
                
                // Add your Gemini API Key here
                const apiKey = "AIzaSyA2OvcgpxDDwU9PdecmE5P4lIDrWZ5b8yc"; 
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error?.message || `API error: ${response.status}`);
                    }

                    const result = await response.json();
                    const text = result?.candidates?.[0]?.content?.parts?.[0]?.text || "No career opportunities found. Please try again with different details.";
                    
                    resultsDiv.innerHTML = formatOpportunities(text);
                    outputDiv.classList.remove('hidden');
                    additionalFeaturesDiv.classList.remove('hidden');

                } catch (error) {
                    console.error('An error occurred:', error);
                    errorText.textContent = 'Failed to get career opportunities. ' + error.message;
                    errorDiv.classList.remove('hidden');
                } finally {
                    loadingDiv.classList.add('hidden');
                }
            });

            // Event listener for generating the cover letter
            coverLetterBtn.addEventListener('click', () => {
                const prompt = `Write a professional cover letter for a job as a ${studentProfile.jobTitle || 'Career Opportunity'} based on the following applicant details. The letter should highlight their skills and enthusiasm.
                
                Applicant Profile:
                - Education: ${studentProfile.education} in ${studentProfile.major}
                - Skills: ${studentProfile.skills}
                - Interests & Hobbies: ${studentProfile.interests}
                - Career Goals: ${studentProfile.goals}`;
                
                handleAPIRequest(prompt, coverLetterContent);
            });
            
            // Event listener for generating interview prep
            interviewPrepBtn.addEventListener('click', () => {
                const prompt = `Generate a list of 5 common interview questions for a ${studentProfile.jobTitle || 'Career Opportunity'} position, and provide a brief, professional suggested answer for each question based on the following candidate profile.
                
                Candidate Profile:
                - Education: ${studentProfile.education} in ${studentProfile.major}
                - Skills: ${studentProfile.skills}
                - Interests & Hobbies: ${studentProfile.interests}
                - Career Goals: ${studentProfile.goals}`;

                handleAPIRequest(prompt, interviewPrepContent);
            });

            // Event listener for career roadmap generation
            generateRoadmapBtn.addEventListener('click', () => {
                const prompt = `Generate a step-by-step career roadmap for a student. The student's profile is as follows:
                - Education: ${studentProfile.education} in ${studentProfile.major}
                - Skills: ${studentProfile.skills}
                - Interests: ${studentProfile.interests}
                - Career Goals: ${studentProfile.goals}
                
                The roadmap should be structured with actionable steps over a timeline, including educational milestones, skill development, networking, and job search strategies. Make the output professional and easy to follow.`;

                handleAPIRequest(prompt, roadmapContent);
            });

            // Event listener for copy buttons
            copyCoverLetterBtn.addEventListener('click', () => {
                const textToCopy = coverLetterContent.innerText;
                if (textToCopy) {
                    copyToClipboard(textToCopy);
                    copyCoverLetterBtn.textContent = 'Copied!';
                    setTimeout(() => copyCoverLetterBtn.textContent = 'Copy to Clipboard', 2000);
                }
            });
            copyInterviewPrepBtn.addEventListener('click', () => {
                const textToCopy = interviewPrepContent.innerText;
                if (textToCopy) {
                    copyToClipboard(textToCopy);
                    copyInterviewPrepBtn.textContent = 'Copied!';
                    setTimeout(() => copyInterviewPrepBtn.textContent = 'Copy to Clipboard', 2000);
                }
            });
            copyRoadmapBtn.addEventListener('click', () => {
                const textToCopy = roadmapContent.innerText;
                if (textToCopy) {
                    copyToClipboard(textToCopy);
                    copyRoadmapBtn.textContent = 'Copied!';
                    setTimeout(() => copyRoadmapBtn.textContent = 'Copy to Clipboard', 2000);
                }
            });

            function copyToClipboard(text) {
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
            }

            // This function formats the plain text response for the career opportunities list
            function formatOpportunities(text) {
                let html = text.replace(/\*\*(.*?)\*\*/g, '<h3>$1</h3>'); // Convert bolded text to H3
                html = html.replace(/^(.*?):\s*(.*)/gm, '<h4>$1:</h4><p>$2</p>'); // Convert titles to H4
                html = html.replace(/\n\n/g, '<br><br>'); // Add breaks for paragraphs
                
                // Extract the first job title to use for the additional features
                const match = html.match(/<h3[^>]*>(.*?)<\/h3>/);
                if (match && match[1]) {
                    studentProfile.jobTitle = match[1];
                }

                return html;
            }

            // This function formats the general text response into a more readable format
            function formatResponse(text) {
                let html = text.replace(/\*\*(.*?)\*\*/g, '<h3>$1</h3>');
                html = html.replace(/\n\n/g, '<br><br>');
                return html;
            }
        });
    </script>
</body>
</html>